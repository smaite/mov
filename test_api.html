<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication API Tester</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .primary { color: #ff6b35; }
        .bg-primary { background-color: #ff6b35; }
        code { background: #f5f5f5; padding: 2px 6px; border-radius: 3px; }
        pre { background: #f5f5f5; padding: 12px; border-radius: 6px; overflow-x: auto; }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-4xl font-bold mb-2 primary">üîê Sasto Hub Auth API Tester</h1>
        <p class="text-gray-600 mb-8">Test login and registration endpoints</p>

        <div class="grid md:grid-cols-2 gap-8">
            <!-- Login Section -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-4">Login</h2>
                <form id="loginForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="loginEmail" value="customer@test.com" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="user@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <input type="password" id="loginPassword" value="password" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="password">
                    </div>
                    <button type="submit" class="w-full bg-primary text-white py-2 px-4 rounded-lg hover:opacity-90 font-semibold">Login</button>
                </form>
                <div id="loginResult" class="mt-4 hidden">
                    <div class="bg-green-50 border border-green-200 rounded p-4 text-sm">
                        <pre id="loginResultText" class="text-xs"></pre>
                    </div>
                </div>
            </div>

            <!-- Register Section -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-bold mb-4">Register</h2>
                <form id="registerForm" class="space-y-4">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">First Name</label>
                            <input type="text" id="regFirstName" value="John" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="John">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Last Name</label>
                            <input type="text" id="regLastName" value="Doe" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="Doe">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="regEmail" value="newuser@example.com" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="user@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                        <input type="text" id="regUsername" value="johndoe123" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="johndoe">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password (min 6 chars)</label>
                        <input type="password" id="regPassword" value="password123" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="password">
                    </div>
                    <button type="submit" class="w-full bg-primary text-white py-2 px-4 rounded-lg hover:opacity-90 font-semibold">Register</button>
                </form>
                <div id="registerResult" class="mt-4 hidden">
                    <div class="bg-green-50 border border-green-200 rounded p-4 text-sm">
                        <pre id="registerResultText" class="text-xs"></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Documentation -->
        <div class="bg-white rounded-lg shadow p-6 mt-8">
            <h2 class="text-2xl font-bold mb-4">üìö API Documentation</h2>

            <div class="space-y-6">
                <!-- Login Endpoint -->
                <div class="border-b pb-6">
                    <h3 class="text-xl font-semibold mb-2">POST /api/auth.php?action=login</h3>
                    <p class="text-gray-600 mb-3">Authenticate user with email and password</p>
                    
                    <div class="bg-gray-50 p-4 rounded mb-3">
                        <p class="font-semibold text-sm mb-2">Request Parameters (Form Data):</p>
                        <pre>email (required)      - User email address
password (required)  - User password</pre>
                    </div>

                    <div class="bg-gray-50 p-4 rounded mb-3">
                        <p class="font-semibold text-sm mb-2">Success Response (200):</p>
                        <pre>{
  "success": true,
  "message": "Login successful",
  "user": {
    "id": 1,
    "username": "customer1",
    "email": "customer@test.com",
    "first_name": "Test",
    "last_name": "Customer",
    "user_type": "customer"
  }
}</pre>
                    </div>

                    <div class="bg-red-50 p-4 rounded">
                        <p class="font-semibold text-sm mb-2">Error Response (401):</p>
                        <pre>{
  "error": "Invalid email or password"
}</pre>
                    </div>
                </div>

                <!-- Register Endpoint -->
                <div>
                    <h3 class="text-xl font-semibold mb-2">POST /api/auth.php?action=register</h3>
                    <p class="text-gray-600 mb-3">Register new user account</p>
                    
                    <div class="bg-gray-50 p-4 rounded mb-3">
                        <p class="font-semibold text-sm mb-2">Request Parameters (Form Data):</p>
                        <pre>first_name (required) - User's first name
last_name (required)  - User's last name
email (required)      - Email address (must be valid and unique)
username (required)   - Username (must be unique)
password (required)   - Password (minimum 6 characters)</pre>
                    </div>

                    <div class="bg-gray-50 p-4 rounded mb-3">
                        <p class="font-semibold text-sm mb-2">Success Response (201):</p>
                        <pre>{
  "success": true,
  "message": "Registration successful",
  "user": {
    "id": 10,
    "username": "johndoe123",
    "email": "newuser@example.com",
    "first_name": "John",
    "last_name": "Doe",
    "user_type": "customer"
  }
}</pre>
                    </div>

                    <div class="bg-red-50 p-4 rounded">
                        <p class="font-semibold text-sm mb-2">Error Response Examples:</p>
                        <pre>400: {"error": "Email or username already exists"}
400: {"error": "Password must be at least 6 characters"}
400: {"error": "Invalid email"}</pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Credentials -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg shadow p-6 mt-8">
            <h2 class="text-2xl font-bold mb-4 text-blue-900">üß™ Test Credentials</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-white p-4 rounded">
                    <h3 class="font-semibold text-blue-900 mb-2">Customer</h3>
                    <p class="text-sm"><strong>Email:</strong> customer@test.com</p>
                    <p class="text-sm"><strong>Password:</strong> password</p>
                    <p class="text-sm text-gray-600 mt-2">Username: customer1</p>
                </div>
                <div class="bg-white p-4 rounded">
                    <h3 class="font-semibold text-blue-900 mb-2">Vendor</h3>
                    <p class="text-sm"><strong>Email:</strong> vendor@test.com</p>
                    <p class="text-sm"><strong>Password:</strong> password</p>
                    <p class="text-sm text-gray-600 mt-2">Username: vendor</p>
                </div>
                <div class="bg-white p-4 rounded">
                    <h3 class="font-semibold text-blue-900 mb-2">Admin</h3>
                    <p class="text-sm"><strong>Email:</strong> admin@sastohub.com</p>
                    <p class="text-sm"><strong>Password:</strong> password</p>
                    <p class="text-sm text-gray-600 mt-2">Username: admin</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Login Form
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            const formData = new FormData();
            formData.append('email', email);
            formData.append('password', password);

            try {
                const response = await fetch('/mov/api/auth.php?action=login', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                showResult('loginResult', 'loginResultText', data, response.status);
            } catch (error) {
                showError('loginResult', 'loginResultText', error.message);
            }
        });

        // Register Form
        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData();
            formData.append('first_name', document.getElementById('regFirstName').value);
            formData.append('last_name', document.getElementById('regLastName').value);
            formData.append('email', document.getElementById('regEmail').value);
            formData.append('username', document.getElementById('regUsername').value);
            formData.append('password', document.getElementById('regPassword').value);

            try {
                const response = await fetch('/mov/api/auth.php?action=register', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                showResult('registerResult', 'registerResultText', data, response.status);
            } catch (error) {
                showError('registerResult', 'registerResultText', error.message);
            }
        });

        function showResult(resultId, textId, data, status) {
            const resultDiv = document.getElementById(resultId);
            const resultText = document.getElementById(textId);
            
            resultDiv.classList.remove('hidden');
            resultText.textContent = JSON.stringify(data, null, 2);
            
            if (status >= 200 && status < 300) {
                resultDiv.classList.add('bg-green-50', 'border-green-200');
                resultDiv.classList.remove('bg-red-50', 'border-red-200');
            } else {
                resultDiv.classList.add('bg-red-50', 'border-red-200');
                resultDiv.classList.remove('bg-green-50', 'border-green-200');
            }
        }

        function showError(resultId, textId, error) {
            showResult(resultId, textId, { error: error }, 500);
        }
    </script>
</body>
</html>
